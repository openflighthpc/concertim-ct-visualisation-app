import e from"chart.js";import o from"hammerjs";var a={};
/*!
 * @license
 * chartjs-plugin-zoom
 * http://chartjs.org/
 * Version: 0.7.7
 *
 * Copyright 2020 Chart.js Contributors
 * Released under the MIT license
 * https://github.com/chartjs/chartjs-plugin-zoom/blob/master/LICENSE.md
 */(function(n,t){a=t(e,o)})(a,(function(e,o){e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e;o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o["default"]:o;var a=e.helpers;var n=e.Zoom=e.Zoom||{};var t=n.zoomFunctions=n.zoomFunctions||{};var i=n.panFunctions=n.panFunctions||{};e.Zoom.defaults=e.defaults.global.plugins.zoom={pan:{enabled:false,mode:"xy",speed:20,threshold:10},zoom:{enabled:false,mode:"xy",sensitivity:3,speed:.1}};function resolveOptions(e,o){var n={};"undefined"!==typeof e.options.pan&&(n.pan=e.options.pan);"undefined"!==typeof e.options.zoom&&(n.zoom=e.options.zoom);var t=e.$zoom;o=t._options=a.merge({},[o,n]);var i=t._node;var r=o.zoom&&o.zoom.enabled;var l=o.zoom.drag;r&&!l?i.addEventListener("wheel",t._wheelHandler, { passive: true }):i.removeEventListener("wheel",t._wheelHandler, { passive: true });if(r&&l){i.addEventListener("mousedown",t._mouseDownHandler);i.ownerDocument.addEventListener("mouseup",t._mouseUpHandler)}else{i.removeEventListener("mousedown",t._mouseDownHandler);i.removeEventListener("mousemove",t._mouseMoveHandler);i.ownerDocument.removeEventListener("mouseup",t._mouseUpHandler)}}function storeOriginalOptions(e){var o=e.$zoom._originalOptions;a.each(e.scales,(function(e){o[e.id]||(o[e.id]=a.clone(e.options))}));a.each(o,(function(a,n){e.scales[n]||delete o[n]}))}function directionEnabled(e,o,a){return void 0===e||("string"===typeof e?-1!==e.indexOf(o):"function"===typeof e&&-1!==e({chart:a}).indexOf(o))}function rangeMaxLimiter(e,o){if(e.scaleAxes&&e.rangeMax&&!a.isNullOrUndef(e.rangeMax[e.scaleAxes])){var n=e.rangeMax[e.scaleAxes];o>n&&(o=n)}return o}function rangeMinLimiter(e,o){if(e.scaleAxes&&e.rangeMin&&!a.isNullOrUndef(e.rangeMin[e.scaleAxes])){var n=e.rangeMin[e.scaleAxes];o<n&&(o=n)}return o}function zoomCategoryScale(e,o,a,t){var i=e.chart.data.labels;var r=e.minIndex;var l=i.length-1;var m=e.maxIndex;var s=t.sensitivity;var c=e.isHorizontal()?e.left+e.width/2:e.top+e.height/2;var v=e.isHorizontal()?a.x:a.y;n.zoomCumulativeDelta=o>1?n.zoomCumulativeDelta+1:n.zoomCumulativeDelta-1;if(Math.abs(n.zoomCumulativeDelta)>s){if(n.zoomCumulativeDelta<0){v>=c?r<=0?m=Math.min(l,m+1):r=Math.max(0,r-1):v<c&&(m>=l?r=Math.max(0,r-1):m=Math.min(l,m+1));n.zoomCumulativeDelta=0}else if(n.zoomCumulativeDelta>0){v>=c?r=r<m?r=Math.min(m,r+1):r:v<c&&(m=m>r?m=Math.max(r,m-1):m);n.zoomCumulativeDelta=0}e.options.ticks.min=rangeMinLimiter(t,i[r]);e.options.ticks.max=rangeMaxLimiter(t,i[m])}}function zoomNumericalScale(e,o,a,n){var t=e.max-e.min;var i=t*(o-1);var r=e.isHorizontal()?a.x:a.y;var l=(e.getValueForPixel(r)-e.min)/t;var m=1-l;var s=i*l;var c=i*m;e.options.ticks.min=rangeMinLimiter(n,e.min+s);e.options.ticks.max=rangeMaxLimiter(n,e.max-c)}function zoomTimeScale(e,o,a,n){zoomNumericalScale(e,o,a,n);var t=e.options;if(t.time){t.time.min&&(t.time.min=t.ticks.min);t.time.max&&(t.time.max=t.ticks.max)}}function zoomScale(e,o,a,n){var i=t[e.type];i&&i(e,o,a,n)}function doZoom(e,o,n,t,i,r){var l=e.chartArea;t||(t={x:(l.left+l.right)/2,y:(l.top+l.bottom)/2});var m=e.$zoom._options.zoom;if(m.enabled){storeOriginalOptions(e);var s="function"===typeof m.mode?m.mode({chart:e}):m.mode;var c;c="xy"===s&&void 0!==i?i:"xy";a.each(e.scales,(function(a){if(a.isHorizontal()&&directionEnabled(s,"x",e)&&directionEnabled(c,"x",e)){m.scaleAxes="x";zoomScale(a,o,t,m)}else if(!a.isHorizontal()&&directionEnabled(s,"y",e)&&directionEnabled(c,"y",e)){m.scaleAxes="y";zoomScale(a,n,t,m)}}));r?e.update({duration:r,easing:"easeOutQuad"}):e.update(0);"function"===typeof m.onZoom&&m.onZoom({chart:e})}}function panCategoryScale(e,o,a){var t=e.chart.data.labels;var i=t.length-1;var r=Math.max(e.ticks.length,1);var l=a.speed;var m=e.minIndex;var s=Math.round(e.width/(r*l));var c;n.panCumulativeDelta+=o;m=n.panCumulativeDelta>s?Math.max(0,m-1):n.panCumulativeDelta<-s?Math.min(i-r+1,m+1):m;n.panCumulativeDelta=m!==e.minIndex?0:n.panCumulativeDelta;c=Math.min(i,m+r-1);e.options.ticks.min=rangeMinLimiter(a,t[m]);e.options.ticks.max=rangeMaxLimiter(a,t[c])}function panNumericalScale(e,o,n){var t=e.options.ticks;var i=e.min;var r=e.max;var l=e.getValueForPixel(e.getPixelForValue(i)-o);var m=e.getValueForPixel(e.getPixelForValue(r)-o);l=l.valueOf?l.valueOf():l;m=m.valueOf?m.valueOf():m;var s=l;var c=m;var v;n.scaleAxes&&n.rangeMin&&!a.isNullOrUndef(n.rangeMin[n.scaleAxes])&&(s=n.rangeMin[n.scaleAxes]);n.scaleAxes&&n.rangeMax&&!a.isNullOrUndef(n.rangeMax[n.scaleAxes])&&(c=n.rangeMax[n.scaleAxes]);if(l>=s&&m<=c){t.min=l;t.max=m}else if(l<s){v=i-s;t.min=s;t.max=r-v}else if(m>c){v=c-r;t.max=c;t.min=i+v}}function panTimeScale(e,o,a){panNumericalScale(e,o,a);var n=e.options;if(n.time){n.time.min&&(n.time.min=n.ticks.min);n.time.max&&(n.time.max=n.ticks.max)}}function panScale(e,o,a){var n=i[e.type];n&&n(e,o,a)}function doPan(e,o,n){storeOriginalOptions(e);var t=e.$zoom._options.pan;if(t.enabled){var i="function"===typeof t.mode?t.mode({chart:e}):t.mode;a.each(e.scales,(function(a){if(a.isHorizontal()&&directionEnabled(i,"x",e)&&0!==o){t.scaleAxes="x";panScale(a,o,t)}else if(!a.isHorizontal()&&directionEnabled(i,"y",e)&&0!==n){t.scaleAxes="y";panScale(a,n,t)}}));e.update(0);"function"===typeof t.onPan&&t.onPan({chart:e})}}function getXAxis(e){var o=e.scales;var a=Object.keys(o);for(var n=0;n<a.length;n++){var t=o[a[n]];if(t.isHorizontal())return t}}function getYAxis(e){var o=e.scales;var a=Object.keys(o);for(var n=0;n<a.length;n++){var t=o[a[n]];if(!t.isHorizontal())return t}}n.zoomFunctions.category=zoomCategoryScale;n.zoomFunctions.time=zoomTimeScale;n.zoomFunctions.linear=zoomNumericalScale;n.zoomFunctions.logarithmic=zoomNumericalScale;n.panFunctions.category=panCategoryScale;n.panFunctions.time=panTimeScale;n.panFunctions.linear=panNumericalScale;n.panFunctions.logarithmic=panNumericalScale;n.panCumulativeDelta=0;n.zoomCumulativeDelta=0;var r={id:"zoom",afterInit:function(e){e.resetZoom=function(){storeOriginalOptions(e);var o=e.$zoom._originalOptions;a.each(e.scales,(function(e){var a=e.options.time;var n=e.options.ticks;if(o[e.id]){if(a){a.min=o[e.id].time.min;a.max=o[e.id].time.max}if(n){n.min=o[e.id].ticks.min;n.max=o[e.id].ticks.max}}else{if(a){delete a.min;delete a.max}if(n){delete n.min;delete n.max}}}));e.update()}},beforeUpdate:function(e,o){resolveOptions(e,o)},beforeInit:function(e,a){e.$zoom={_originalOptions:{}};var t=e.$zoom._node=e.ctx.canvas;resolveOptions(e,a);var i=e.$zoom._options;var r=i.pan&&i.pan.threshold;e.$zoom._mouseDownHandler=function(o){t.addEventListener("mousemove",e.$zoom._mouseMoveHandler);e.$zoom._dragZoomStart=o};e.$zoom._mouseMoveHandler=function(o){if(e.$zoom._dragZoomStart){e.$zoom._dragZoomEnd=o;e.update(0)}};e.$zoom._mouseUpHandler=function(o){if(e.$zoom._dragZoomStart){t.removeEventListener("mousemove",e.$zoom._mouseMoveHandler);var a=e.$zoom._dragZoomStart;var n=a.target.getBoundingClientRect().left;var r=Math.min(a.clientX,o.clientX)-n;var l=Math.max(a.clientX,o.clientX)-n;var m=a.target.getBoundingClientRect().top;var s=Math.min(a.clientY,o.clientY)-m;var c=Math.max(a.clientY,o.clientY)-m;var v=l-r;var u=c-s;e.$zoom._dragZoomStart=null;e.$zoom._dragZoomEnd=null;var d=i.zoom&&i.zoom.threshold||0;if(!(v<=d&&u<=d)){var p=e.chartArea;var f=e.$zoom._options.zoom;var g=p.right-p.left;var x=directionEnabled(f.mode,"x",e);var z=x&&v?1+(g-v)/g:1;var h=p.bottom-p.top;var y=directionEnabled(f.mode,"y",e);var _=y&&u?1+(h-u)/h:1;doZoom(e,z,_,{x:(r-p.left)/(1-v/g)+p.left,y:(s-p.top)/(1-u/h)+p.top},void 0,f.drag.animationDuration);"function"===typeof f.onZoomComplete&&f.onZoomComplete({chart:e})}}};var l=null;e.$zoom._wheelHandler=function(o){o.cancelable&&o.preventDefault();if("undefined"!==typeof o.deltaY){var a=o.target.getBoundingClientRect();var n=o.clientX-a.left;var t=o.clientY-a.top;var i={x:n,y:t};var r=e.$zoom._options.zoom;var m=r.speed;o.deltaY>=0&&(m=-m);doZoom(e,1+m,1+m,i);clearTimeout(l);l=setTimeout((function(){"function"===typeof r.onZoomComplete&&r.onZoomComplete({chart:e})}),250)}};if(o){var m=new o.Manager(t);m.add(new o.Pinch);m.add(new o.Pan({threshold:r}));var s;var handlePinch=function(o){var a=1/s*o.scale;var n=o.target.getBoundingClientRect();var t=o.center.x-n.left;var i=o.center.y-n.top;var r={x:t,y:i};var l=Math.abs(o.pointers[0].clientX-o.pointers[1].clientX);var m=Math.abs(o.pointers[0].clientY-o.pointers[1].clientY);var c=l/m;var v;v=c>.3&&c<1.7?"xy":l>m?"x":"y";doZoom(e,a,a,r,v);var u=e.$zoom._options.zoom;"function"===typeof u.onZoomComplete&&u.onZoomComplete({chart:e});s=o.scale};m.on("pinchstart",(function(){s=1}));m.on("pinch",handlePinch);m.on("pinchend",(function(e){handlePinch(e);s=null;n.zoomCumulativeDelta=0}));var c=null;var v=null;var u=false;var handlePan=function(o){if(null!==c&&null!==v){u=true;var a=o.deltaX-c;var n=o.deltaY-v;c=o.deltaX;v=o.deltaY;doPan(e,a,n)}};m.on("panstart",(function(e){c=0;v=0;handlePan(e)}));m.on("panmove",handlePan);m.on("panend",(function(){c=null;v=null;n.panCumulativeDelta=0;setTimeout((function(){u=false}),500);var o=e.$zoom._options.pan;"function"===typeof o.onPanComplete&&o.onPanComplete({chart:e})}));e.$zoom._ghostClickHandler=function(e){if(u&&e.cancelable){e.stopImmediatePropagation();e.preventDefault()}};t.addEventListener("click",e.$zoom._ghostClickHandler);e._mc=m}},beforeDatasetsDraw:function(e){var o=e.ctx;if(e.$zoom._dragZoomEnd){var a=getXAxis(e);var n=getYAxis(e);var t=e.$zoom._dragZoomStart;var i=e.$zoom._dragZoomEnd;var r=a.left;var l=a.right;var m=n.top;var s=n.bottom;if(directionEnabled(e.$zoom._options.zoom.mode,"x",e)){var c=t.target.getBoundingClientRect().left;r=Math.min(t.clientX,i.clientX)-c;l=Math.max(t.clientX,i.clientX)-c}if(directionEnabled(e.$zoom._options.zoom.mode,"y",e)){var v=t.target.getBoundingClientRect().top;m=Math.min(t.clientY,i.clientY)-v;s=Math.max(t.clientY,i.clientY)-v}var u=l-r;var d=s-m;var p=e.$zoom._options.zoom.drag;o.save();o.beginPath();o.fillStyle=p.backgroundColor||"rgba(225,225,225,0.3)";o.fillRect(r,m,u,d);if(p.borderWidth>0){o.lineWidth=p.borderWidth;o.strokeStyle=p.borderColor||"rgba(225,225,225)";o.strokeRect(r,m,u,d)}o.restore()}},destroy:function(e){if(e.$zoom){var o=e.$zoom;var a=o._node;a.removeEventListener("mousedown",o._mouseDownHandler);a.removeEventListener("mousemove",o._mouseMoveHandler);a.ownerDocument.removeEventListener("mouseup",o._mouseUpHandler);a.removeEventListener("wheel",o._wheelHandler);a.removeEventListener("click",o._ghostClickHandler);delete e.$zoom;var n=e._mc;if(n){n.remove("pinchstart");n.remove("pinch");n.remove("pinchend");n.remove("panstart");n.remove("pan");n.remove("panend");n.destroy()}}}};e.plugins.register(r);return r}));var n=a;export default n;

